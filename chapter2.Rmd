# Week 2 

In this week's R exercise we are making the regression analysis from the questionare data about students' learning methods (deep and surface learning) and attitudes toward the learning progress and study subject. The answers are scaled and combined together with final exam points, overall attitudes toward statistics, gender and age. 

Before the analysis, we did data wrangling step (where the data table is converted into different type of file for analysis), and in this step the data was already filtered so that those answers that got 0 points are left out from the data table, the deep, strategic and learning question points were averiged and the attitude points were divided by the number of questions (about attitude). 



**Tables 1-3. Data tables about summary of data and its structure.** Data table has seven different variables. The first variable is gender, which can be either female or male. The next one is age, and has integer value, as well as the exam points in the table. Other points in the table are averiged values from the multiple questions from that spesific topic.

```{r}
# Reading the data into R (students2014) from the  local data wrangling file (learning2014.txt). Setting the header=TRUE because file contains the names of the variables as its first line.

students2014<-read.table("~/Tiedostot_J/IODS-project/data/learning2014.txt", header=TRUE)

#Analysis of the data (structure and summary)


str(students2014)
head(students2014)

summary(students2014)


```

**Plot 1.** To summarize we have made a plot for attitude vs exam points. These results are divided on two colours based on the gender and lastly regression line is drawn to the plot to visualize if there is a gender difference.

```{r}
#Accessing libraries ggplot2 and GGally
library(ggplot2)
library(GGally)

#  Plot with ggplot (aes)
p1 <- ggplot(students2014, aes(x = attitude, y = points, col = gender))

#  point visualization
p2 <- p1 + geom_point()

# adding a regression line
p3 <- p2 + geom_smooth(method = "lm")

# adding a title and drawing the plot
p4 <- p3 + ggtitle("Student's attitude vs exam points")

# printing the plot
p4
```

**Plot 2.** Plot about the summaries of the variables in the data. In this plot there is easily seen the different relationships between the variables.

```{r}




# Drawing plot matrix with ggpairs()
p <- ggpairs(students2014, mapping = aes(col=gender, alpha=2), lower = list(combo = wrap("facethist", bins = 20)))


# draw the plot
p
```

**Table 4.** In this table, there is actual linear regression model for multiple variables used. The exam points are the target of the analysis and it gives the model to us as well as the details about the residuals in the model. From coefficients we can see where it crosses the Y-axis (points, intercept) and the model also estimates for each variable, if it is significant from zero. In other words, does that variable make a difference to the points (P and t values). The attitude seems to have the highest impact to exam points between these three variables.

The multiple R squared of the model tells us how well this data fits into multiple linear regression model. It determines how well the residuals fit the theoretical model values. More we have outliers from the model, the lower we have R squared value of the model telling us that some other model would be needed to explain our data. In our case, it seems that there is quite a lot variability of the data, meaning that it is not that strong dependence on the exam points and between attitude, age and strategic learning.


```{r}
# creating a regression model with multiple explanatory variables
my_model <- lm(points ~ attitude + age + stra, data = students2014)

# print out a summary of the model
summary(my_model)

```

**Plot 3.** Analysis of these diagnostic plots shows in the first plot again how well the residuals are corresponding the model fitted values. It should be scattered and not showing any kind of trend in this plot. The second plot is about normal QQ which is normality of errors. It should show no trend again going on some direction from the trendline. The third plot is about the leverage and residuals, and it takes into account that some residuals might have a larger effect on a model fitting than other. For example, large values might have larger effect than smaller ones when regression curve is fitted. 

```{r}

# drawing diagnostic plots with plot(). Choosing the plots 1, 2 and 5. Par to show multiple plots at the same time (room for four plots, only 3 used here)
par(mfrow=c(2,2))
plot(my_model, which=c(1:2,5))


